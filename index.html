<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç”Ÿå­˜æ³•åˆ™ï¼šæ‹¥æŒ¤çš„å¤œæ™š</title>
    <style>
        :root {
            --bg-color: #121212;
            --accent-yellow: #F7B500;
            --accent-red: #FF3B30;
            --accent-blue: #007AFF;
            --text-main: #FFFFFF;
            --glass: rgba(255, 255, 255, 0.1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; touch-action: manipulation; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            height: 100vh;
            overflow: hidden;
            background-image: radial-gradient(circle at 50% 10%, #2a2a2a 0%, #121212 100%);
        }

        /* é¡µé¢å®¹å™¨ */
        .page {
            position: absolute; width: 100%; height: 100%;
            display: none; flex-direction: column; justify-content: center; align-items: center;
            padding: 30px; text-align: center;
            transition: opacity 0.5s ease;
        }
        .page.active { display: flex; animation: slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1); }

        /* é€šç”¨ç»„ä»¶ */
        h1 { font-size: 26px; margin-bottom: 10px; font-weight: 800; line-height: 1.3; text-shadow: 0 2px 10px rgba(0,0,0,0.5); }
        h2 { font-size: 16px; color: #aaa; margin-bottom: 30px; font-weight: 400; }
        p { font-size: 16px; line-height: 1.6; color: #ddd; margin-bottom: 20px; }

        .emoji-stage {
            font-size: 80px; margin: 20px 0; min-height: 120px;
            filter: drop-shadow(0 0 10px rgba(255,255,255,0.2));
            transition: all 0.3s;
        }

        .btn {
            background: linear-gradient(135deg, var(--accent-yellow), #e0a800);
            color: #000; border: none; padding: 16px 40px;
            font-size: 18px; font-weight: 700; border-radius: 50px;
            box-shadow: 0 4px 15px rgba(247, 181, 0, 0.4);
            cursor: pointer; position: relative; overflow: hidden;
            transition: transform 0.1s; width: 80%; max-width: 300px;
        }
        .btn:active { transform: scale(0.95); }
        .btn-outline { background: transparent; border: 2px solid var(--accent-yellow); color: var(--accent-yellow); box-shadow: none; margin-top: 15px; }
        
        /* è¿›åº¦æ¡/æŒ‡ç¤ºå™¨ */
        .progress-dots { position: fixed; top: 20px; display: flex; gap: 5px; }
        .dot { width: 8px; height: 8px; background: #333; border-radius: 50%; }
        .dot.active { background: var(--accent-yellow); box-shadow: 0 0 5px var(--accent-yellow); }

        /* å¼¹çª—Toast */
        #toast {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.8);
            background: rgba(20, 20, 20, 0.95); border: 1px solid #333;
            padding: 20px 30px; border-radius: 12px; z-index: 100;
            text-align: center; opacity: 0; pointer-events: none; transition: all 0.3s;
            box-shadow: 0 10px 30px rgba(0,0,0,0.8);
        }
        #toast.show { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        #toast.good { border-color: var(--accent-yellow); color: var(--accent-yellow); }
        #toast.bad { border-color: var(--accent-red); color: var(--accent-red); }

        /* --- ç‰¹æ®Šäº¤äº’æ ·å¼ --- */

        /* P2: æ»‘åŠ¨æ¡ */
        input[type=range] { width: 100%; margin: 20px 0; accent-color: var(--accent-red); }
        .crowd-container { display: flex; flex-wrap: wrap; justify-content: center; width: 200px; gap: 5px; margin: 0 auto; }
        .tiny-person { font-size: 20px; transition: 0.3s; }

        /* P4: èº«ä½“ç‚¹å‡»ç‚¹ */
        .body-target {
            width: 50px; height: 50px; background: rgba(255, 255, 255, 0.2);
            border: 2px solid var(--accent-yellow); border-radius: 50%;
            position: absolute; animation: pulse 1.5s infinite; cursor: pointer;
        }
        .body-container { position: relative; width: 200px; height: 200px; margin: 0 auto; }
        
        /* P7: è¿å‡»æŒ‰é’® */
        #shout-meter { width: 100%; height: 20px; background: #333; border-radius: 10px; overflow: hidden; margin-bottom: 10px; }
        #shout-fill { height: 100%; width: 0%; background: linear-gradient(90deg, var(--accent-blue), var(--accent-yellow)); transition: width 0.1s; }

        /* åŠ¨ç”»å…³é”®å¸§ */
        @keyframes slideUp { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes pulse { 0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(247, 181, 0, 0.7); } 70% { transform: scale(1.1); box-shadow: 0 0 0 10px rgba(247, 181, 0, 0); } 100% { transform: scale(1); } }
        @keyframes shake { 0% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } 100% { transform: translateX(0); } }
        @keyframes drift { 0% { transform: translateY(0px) rotate(0deg); } 50% { transform: translateY(-10px) rotate(2deg); } 100% { transform: translateY(0px) rotate(0deg); } }

    </style>
</head>
<body>

    <div class="progress-dots" id="dots">
        <div class="dot active"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div>
        <div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div>
    </div>

    <div class="page active" id="p1">
        <div class="emoji-stage" style="animation: drift 3s infinite ease-in-out;">ğŸŒƒğŸ‘»ğŸ‰</div>
        <h1>æ‹¥æŒ¤çš„å¤œæ™š<br><span style="color:var(--accent-yellow)">ç”Ÿå­˜æ³•åˆ™</span></h1>
        <h2>å½“ç‹‚æ¬¢å˜æˆç¾éš¾ï¼Œä½ çŸ¥é“å¦‚ä½•è‡ªæ•‘å—ï¼Ÿ</h2>
        <button class="btn" onclick="nextPage(2)">å¼€å§‹æ¨¡æ‹Ÿ</button>
    </div>

    <div class="page" id="p2">
        <h1>å±æœºï¼šè‡´å‘½å¯†åº¦</h1>
        <p>æ¢¨æ³°é™¢çš„æ‚²å‰§å‘ç”Ÿåœ¨ä»…3.2ç±³å®½çš„çª„å··ã€‚<br><strong>æ‹–åŠ¨æ»‘å—ï¼Œæ¨¡æ‹Ÿäººç¾¤å¯†åº¦å¢åŠ ã€‚</strong></p>
        <div class="emoji-stage" id="crowd-visual" style="font-size: 40px; min-height:100px; width:220px; background:#222; border-radius:10px; display:flex; flex-wrap:wrap; justify-content:center; align-items:center; overflow:hidden;">
            ğŸ§
        </div>
        <input type="range" id="density-slider" min="1" max="10" value="1" oninput="updateCrowd(this.value)">
        <p id="density-text">å½“å‰ï¼šå®‰å…¨ (1äºº/ã¡)</p>
        <button class="btn" id="btn-p2" style="opacity:0.5; pointer-events:none;" onclick="nextPage(3)">ä¸‹ä¸€æ­¥</button>
    </div>

    <div class="page" id="p3">
        <h1>åŒè„šæ‚¬ç©º</h1>
        <div class="emoji-stage" style="animation: shake 0.2s infinite;">ğŸŒŠğŸ˜µğŸŒŠ</div>
        <p>å½“å¯†åº¦è¾¾åˆ°æç‚¹ï¼Œäººç¾¤ä¼šåƒâ€œæµä½“â€ä¸€æ ·ç§»åŠ¨ï¼Œä½ å°†å¤±å»æ§åˆ¶ã€‚</p>
        <div style="background:var(--glass); padding:15px; border-radius:10px; margin-bottom:20px;">
            âš ï¸ <strong>è­¦å‘Šï¼š</strong> ä¸è¦è¯•å›¾é€†æµè€Œä¸Šï¼
        </div>
        <button class="btn" onclick="nextPage(4)">é¡ºæµè€ŒåŠ¨ â¡ï¸</button>
    </div>

    <div class="page" id="p4">
        <h1>å…³é”®æŠ€èƒ½ï¼šæ¶èµ·ç›¾ç‰Œ</h1>
        <p>å¤§å¤šæ•°é‡éš¾è€…æ­»äº<strong>æœºæ¢°æ€§çª’æ¯</strong>ã€‚<br>è¯·ç‚¹å‡»èº«ä½“éƒ¨ä½ï¼Œå»ºç«‹å‘¼å¸ç©ºé—´ï¼</p>
        <div class="body-container">
            <div class="emoji-stage" id="hero-p4">ğŸ§</div>
            <div class="body-target" style="top:30px; left:-10px;" onclick="lockArm('left')"></div>
            <div class="body-target" style="top:30px; right:-10px;" onclick="lockArm('right')"></div>
        </div>
        <p id="arm-hint" style="color:var(--accent-yellow)">ç‚¹å‡»å·¦å³æ‰‹è‡‚ï¼</p>
    </div>

    <div class="page" id="p5">
        <h1>å¦‚æœä¸å¹¸æ‘”å€’...</h1>
        <div class="emoji-stage" id="fallen-hero">ğŸ›Œ</div>
        <p>ç»ä¸èƒ½å¹³èººï¼<br><strong>é•¿æŒ‰ä¸‹æ–¹æŒ‰é’®</strong>ï¼Œèœ·ç¼©èº«ä½“ä¿æŠ¤å†…è„ï¼</p>
        <button class="btn" id="hold-btn" style="background:var(--accent-red)">é•¿æŒ‰ä¿å‘½</button>
    </div>

    <div class="page" id="p6">
        <h1>ç”Ÿæ­»æŠ‰æ‹©</h1>
        <p>åœ¨æ‹¥æŒ¤çš„äººç¾¤ä¸­ï¼Œä½ çš„æ‰‹æœºæ‰äº†ã€‚</p>
        <div class="emoji-stage">ğŸ“±ğŸ‘Ÿ</div>
        <button class="btn btn-outline" onclick="choice(false)">å¼¯è…°å»æ¡</button>
        <button class="btn" onclick="choice(true)">ç«‹åˆ»æ”¾å¼ƒ</button>
    </div>

    <div class="page" id="p7">
        <h1>ä¼ é€’ä¿¡å·</h1>
        <p>å‰é¢æœ‰äººè·Œå€’ï¼æˆ‘ä»¬éœ€è¦è®©åé¢çš„äººåœä¸‹ã€‚<br><strong>å¿«é€Ÿç‚¹å‡»æŒ‰é’®ï¼Œå¤§å–Š "Back!"</strong></p>
        <div class="emoji-stage" id="shout-emoji">ğŸ“¢</div>
        <div id="shout-meter"><div id="shout-fill"></div></div>
        <button class="btn" onclick="tapShout()">ç‚¹å‡»å‘å–Šï¼</button>
    </div>

    <div class="page" id="p8">
        <div class="emoji-stage">ğŸ–ï¸</div>
        <h1>ç”Ÿå­˜æ¼”ä¹ ç»“æŸ</h1>
        <p>ä½ æŒæ¡äº†æ¢¨æ³°é™¢äº‹æ•…ä¸­æœ€é‡è¦çš„ç”Ÿå­˜æ³•åˆ™ï¼š<br><span style="color:var(--accent-yellow)">ä¸å‡‘çƒ­é—¹ Â· æŠ¤ä½èƒ¸è…” Â· ä¾§å§èœ·ç¼©</span></p>
        <button class="btn" onclick="location.reload()">é‡æ–°æ¼”ä¹ </button>
        <br><br>
        <p style="font-size:12px; opacity:0.5;">è°¨ä»¥æ­¤é¡µé¢ç§‘æ™®å®‰å…¨çŸ¥è¯†<br>æ„¿æ‚²å‰§ä¸å†é‡æ¼”</p>
    </div>

    <div id="toast"></div>

    <script>
        /* å…¨å±€çŠ¶æ€ */
        let currentPage = 1;
        let armsLocked = 0;
        let shoutCount = 0;

        // ç¿»é¡µé€»è¾‘
        function nextPage(pid) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById('p' + pid).classList.add('active');
            updateDots(pid);
            currentPage = pid;
        }

        function updateDots(idx) {
            document.querySelectorAll('.dot').forEach((d, i) => {
                d.classList.toggle('active', i < idx);
            });
        }

        // Toast æç¤º
        function showToast(msg, type) {
            const t = document.getElementById('toast');
            t.className = 'show ' + type;
            t.innerText = msg;
            setTimeout(() => { t.className = ''; }, 1500);
        }

        // P2: å¯†åº¦æ»‘å—é€»è¾‘
        function updateCrowd(val) {
            const visual = document.getElementById('crowd-visual');
            const text = document.getElementById('density-text');
            const btn = document.getElementById('btn-p2');
            
            // ç”Ÿæˆå°äºº
            let html = '';
            for(let i=0; i<val*2; i++) {
                html += '<span class="tiny-person">ğŸ§</span>';
            }
            visual.innerHTML = html;

            // çŠ¶æ€åˆ¤æ–­
            if(val < 5) {
                text.innerText = "å½“å‰ï¼šè¿˜æœ‰ç©ºé—´";
                text.style.color = "#fff";
                visual.style.background = "#222";
                btn.style.opacity = 0.5; btn.style.pointerEvents = "none";
            } else if (val < 9) {
                text.innerText = "è­¦å‘Šï¼šæ‹¥æŒ¤å¼€å§‹";
                text.style.color = "var(--accent-yellow)";
            } else {
                text.innerHTML = "ğŸš¨ å±é™©ï¼šå¦‚åŒæµä½“ï¼<br>ææ˜“å‘ç”Ÿè¸©è¸ï¼";
                text.style.color = "var(--accent-red)";
                visual.style.background = "#500";
                // æ¿€æ´»æŒ‰é’®
                btn.style.opacity = 1; btn.style.pointerEvents = "auto";
                btn.innerText = "å±æœºé™ä¸´ (ä¸‹ä¸€æ­¥)";
            }
        }

        // P4: æŠ¤èƒ¸äº¤äº’
        function lockArm(side) {
            const el = event.target;
            el.style.display = 'none'; // éšè—ç‚¹å‡»ç‚¹
            armsLocked++;
            
            if(armsLocked === 1) {
                document.getElementById('hero-p4').innerText = "ğŸ™‹â€â™‚ï¸"; // å•æ‰‹
            } else if (armsLocked === 2) {
                document.getElementById('hero-p4').innerText = "ğŸ™…â€â™‚ï¸"; // åŒæ‰‹æŠ¤èƒ¸
                document.getElementById('hero-p4').style.color = "var(--accent-yellow)";
                document.getElementById('arm-hint').innerText = "å®Œç¾ï¼å½¢æˆäº†å‘¼å¸ä¸‰è§’åŒºï¼";
                showToast("é˜²å¾¡å§¿æ€å®Œæˆï¼", "good");
                setTimeout(() => nextPage(5), 1500);
            }
        }

        // P5: é•¿æŒ‰äº¤äº’
        const holdBtn = document.getElementById('hold-btn');
        let holdTimer;
        
        ['mousedown', 'touchstart'].forEach(evt => 
            holdBtn.addEventListener(evt, (e) => {
                e.preventDefault();
                holdBtn.innerText = "åšæŒä½...";
                document.getElementById('fallen-hero').style.transform = "scale(0.8)";
                
                holdTimer = setTimeout(() => {
                    document.getElementById('fallen-hero').innerText = "ğŸ¤"; // å˜æˆèœ·ç¼©çŠ¶
                    showToast("ä¾§å§æŠ¤ä½äº†è„å™¨ï¼", "good");
                    nextPage(6);
                }, 1000);
            })
        );

        ['mouseup', 'touchend'].forEach(evt => 
            holdBtn.addEventListener(evt, () => {
                clearTimeout(holdTimer);
                holdBtn.innerText = "é•¿æŒ‰ä¿å‘½";
                document.getElementById('fallen-hero').style.transform = "scale(1)";
            })
        );

        // P6: é€‰æ‹©é¢˜
        function choice(isCorrect) {
            if(isCorrect) {
                showToast("æ­£ç¡®ï¼èº«å¤–ä¹‹ç‰©åˆ«ç•™æ‹", "good");
                setTimeout(() => nextPage(7), 1000);
            } else {
                showToast("é”™è¯¯ï¼å¼¯è…°=æ­»äº¡", "bad");
                document.querySelector('.emoji-stage').style.animation = "shake 0.3s";
            }
        }

        // P7: è¿å‡»äº¤äº’
        function tapShout() {
            shoutCount += 10;
            document.getElementById('shout-fill').style.width = shoutCount + '%';
            
            // è§†è§‰åé¦ˆ
            const emoji = document.getElementById('shout-emoji');
            emoji.style.transform = "scale(1.2)";
            setTimeout(()=>emoji.style.transform="scale(1)", 100);

            if(shoutCount >= 100) {
                document.getElementById('shout-emoji').innerText = "ğŸ›‘"; // åœæ­¢æ‰‹åŠ¿
                showToast("äººç¾¤åœæ­¢äº†å‰è¿›ï¼", "good");
                setTimeout(() => nextPage(8), 1500);
            }
        }

    </script>
</body>
</html>